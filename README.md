# Open Problems - Multimodal Single-Cell Integration
Описание и код решения соревнования [Open Problems - Multimodal Single-Cell Integration](https://www.kaggle.com/competitions/open-problems-multimodal)

**Результат**: 81/1220 (7%)

## Описание задачи
По данным клеток, собранных от 4 доноров предсказать
*   для данных Multiome: предсказать экспрессию генов на основе доступности хроматина
*   для данных CITEseq: предсказать уровни белка  на основе экспрессии генов

Фактически, в рамках соревнования предполагалось решить 2 задачи

## Метрика
## Данные 

## Решение
* Было удалено 1194 гена, у которых был одинаковый уровень экспрессии для каждой клетки
* Признаки для обчающей выборки формировались следующим образом: был применен алгоритм понижения размерности TruncatedSVD (выбран, поскольку может эффективно работать с разреженными матрицами), а также добавлялось от 60 до 120 необработанных признаков, выбранных одним из следующих способов:

   1. Путем изучения биологических ресурсов отобраны гены, которые кодируют белки, чьи уровни необходимо предсказать, а также наиболее важные гены
   2. [Признаки](https://github.com/sfnga/Open-Problems-Multimodal-Single-Cell-Integration/blob/main/select-most-correlated.ipynb), с максимальным значением модуля коэффициента корреляции между ними и целевыми переменными
   3. Permutation importance (не хватило времени для реализации). На первом этапе было создано порядка 210 непересекающихся подмножеств признаков (в каждом ~100 признаков), для каждого признака была подсчитана важность на основе перестановки, и из каждого подмножества были отобраны лишь те признаки, у которых важность на основе перестановки была положительной для каждого фолда. Затем предполагалось также разбить отобранные признаки на подмножества и повторить процедуру отбора
* **Модели**: 5 нейронных сетей, обученных на разном подмножестве признаков, 1 Catboost, 1 TabNet.
Каждая модель обучалась на 5 наборах данных, полученных путем применения TruncatedSVD с различными значениями random_state к исходным данным. Это позволило увеличить метрику на 0.0009-0.0011 для каждой модели
*  Подбор весов для ансамбля осуществлялся методом Нелдера-Мида

## Не сработало
*  различные варианты преобразования исходных данных (логарифмирование, возведение в степень от 1/4 до 1)
*  использование статистик для каждой клетки (количество генов с ненулевой экспрессией для каждой клетки составляет 18-27%. Поэтому предполагалось использовать данную информацию для построения признаков: количество генов с ненулевой экспрессией, среднее значение экспрессии генов, медиана экспрессии генов...)
